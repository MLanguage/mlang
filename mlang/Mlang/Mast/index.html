<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Mast (mlang.Mlang.Mast)</title><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">mlang</a> &#x00BB; <a href="../index.html">Mlang</a> &#x00BB; Mast</nav><header class="odoc-preamble"><h1>Module <code><span>Mlang.Mast</span></code></h1><p>Abstract Syntax Tree for M</p></header><nav class="odoc-toc"><ul><li><a href="#abstract-syntax-tree">Abstract Syntax Tree</a><ul><li><a href="#names">Names</a></li><li><a href="#literals">Literals</a></li><li><a href="#loops">Loops</a></li><li><a href="#expressions">Expressions</a></li></ul></li><li><a href="#toplevel-clauses">Toplevel clauses</a><ul><li><a href="#rules">Rules</a></li><li><a href="#variable-declaration">Variable declaration</a><ul><li><a href="#input-variables">Input variables</a></li></ul></li><li><a href="#verification-clauses">Verification clauses</a></li></ul></li><li><a href="#m-programs">M programs</a></li><li><a href="#function-specification-ast">Function specification AST</a></li><li><a href="#helper-functions">Helper functions</a></li></ul></nav><div class="odoc-content"><h2 id="abstract-syntax-tree"><a href="#abstract-syntax-tree" class="anchor"></a>Abstract Syntax Tree</h2><p>This AST is very close to the concrete syntax. It features many elements that are just dropped in later phases of the compiler, but may be used by other DGFiP applications</p><h3 id="names"><a href="#names" class="anchor"></a>Names</h3><div class="odoc-spec"><div class="spec type" id="type-application" class="anchored"><a href="#type-application" class="anchor"></a><code><span><span class="keyword">type</span> application</span><span> = string</span></code></div><div class="spec-doc"><p>Applications are rule annotations. The 3 main DGFiP applications seem to be:</p><ul><li><code>batch</code>: deprecated, used to compute the income tax but not anymore;</li><li><code>bareme</code>: seems to compute the income tax;</li><li><code>iliad</code>: usage unkown, much bigger than <code>bareme</code>.</li></ul></div></div><div class="odoc-spec"><div class="spec module" id="module-DomainId" class="anchored"><a href="#module-DomainId" class="anchor"></a><code><span><span class="keyword">module</span> DomainId</span><span> = <a href="../StrSet/index.html">StrSet</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-DomainIdSet" class="anchored"><a href="#module-DomainIdSet" class="anchor"></a><code><span><span class="keyword">module</span> DomainIdSet</span><span> = <a href="../StrSetSet/index.html">StrSetSet</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-DomainIdMap" class="anchored"><a href="#module-DomainIdMap" class="anchor"></a><code><span><span class="keyword">module</span> DomainIdMap</span><span> = <a href="../StrSetMap/index.html">StrSetMap</a></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-chaining" class="anchored"><a href="#type-chaining" class="anchor"></a><code><span><span class="keyword">type</span> chaining</span><span> = string</span></code></div><div class="spec-doc"><p>&quot;enchaineur&quot; in the M source code, utility unknown</p></div></div><div class="odoc-spec"><div class="spec module" id="module-ChainingSet" class="anchored"><a href="#module-ChainingSet" class="anchor"></a><code><span><span class="keyword">module</span> ChainingSet</span><span> = <a href="../StrSet/index.html">StrSet</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-ChainingMap" class="anchored"><a href="#module-ChainingMap" class="anchor"></a><code><span><span class="keyword">module</span> ChainingMap</span><span> = <a href="../StrMap/index.html">StrMap</a></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-variable_name" class="anchored"><a href="#type-variable_name" class="anchor"></a><code><span><span class="keyword">type</span> variable_name</span><span> = string</span></code></div><div class="spec-doc"><p>Variables are just strings</p></div></div><div class="odoc-spec"><div class="spec type" id="type-func_name" class="anchored"><a href="#type-func_name" class="anchor"></a><code><span><span class="keyword">type</span> func_name</span><span> = string</span></code></div><div class="spec-doc"><p>Func names are just string for the moment</p></div></div><div class="odoc-spec"><div class="spec type" id="type-variable_generic_name" class="anchored"><a href="#type-variable_generic_name" class="anchor"></a><code><span><span class="keyword">type</span> variable_generic_name</span><span> = </span><span>{</span></code><table><tr id="type-variable_generic_name.base" class="anchored"><td class="def record field"><a href="#type-variable_generic_name.base" class="anchor"></a><code><span>base : string;</span></code></td></tr><tr id="type-variable_generic_name.parameters" class="anchored"><td class="def record field"><a href="#type-variable_generic_name.parameters" class="anchor"></a><code><span>parameters : <span>char list</span>;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>For generic variables, we record the list of their lowercase parameters</p></div></div><div class="odoc-spec"><div class="spec type" id="type-error_name" class="anchored"><a href="#type-error_name" class="anchor"></a><code><span><span class="keyword">type</span> error_name</span><span> = string</span></code></div><div class="spec-doc"><p>Ununsed for now</p></div></div><h3 id="literals"><a href="#literals" class="anchor"></a>Literals</h3><div class="odoc-spec"><div class="spec type" id="type-variable" class="anchored"><a href="#type-variable" class="anchor"></a><code><span><span class="keyword">type</span> variable</span><span> = </span></code><table><tr id="type-variable.Normal" class="anchored"><td class="def variant constructor"><a href="#type-variable.Normal" class="anchor"></a><code><span>| </span><span><span class="constructor">Normal</span> <span class="keyword">of</span> <a href="#type-variable_name">variable_name</a></span></code></td></tr><tr id="type-variable.Generic" class="anchored"><td class="def variant constructor"><a href="#type-variable.Generic" class="anchor"></a><code><span>| </span><span><span class="constructor">Generic</span> <span class="keyword">of</span> <a href="#type-variable_generic_name">variable_generic_name</a></span></code></td></tr></table></div><div class="spec-doc"><p>A variable is either generic (with loop parameters) or normal</p></div></div><div class="odoc-spec"><div class="spec type" id="type-literal" class="anchored"><a href="#type-literal" class="anchor"></a><code><span><span class="keyword">type</span> literal</span><span> = </span></code><table><tr id="type-literal.Variable" class="anchored"><td class="def variant constructor"><a href="#type-literal.Variable" class="anchor"></a><code><span>| </span><span><span class="constructor">Variable</span> <span class="keyword">of</span> <a href="#type-variable">variable</a></span></code></td></tr><tr id="type-literal.Float" class="anchored"><td class="def variant constructor"><a href="#type-literal.Float" class="anchor"></a><code><span>| </span><span><span class="constructor">Float</span> <span class="keyword">of</span> float</span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec type" id="type-table_index" class="anchored"><a href="#type-table_index" class="anchor"></a><code><span><span class="keyword">type</span> table_index</span><span> = </span></code><table><tr id="type-table_index.LiteralIndex" class="anchored"><td class="def variant constructor"><a href="#type-table_index.LiteralIndex" class="anchor"></a><code><span>| </span><span><span class="constructor">LiteralIndex</span> <span class="keyword">of</span> int</span></code></td></tr><tr id="type-table_index.SymbolIndex" class="anchored"><td class="def variant constructor"><a href="#type-table_index.SymbolIndex" class="anchor"></a><code><span>| </span><span><span class="constructor">SymbolIndex</span> <span class="keyword">of</span> <a href="#type-variable">variable</a></span></code></td></tr></table></div><div class="spec-doc"><p>A table index is used in expressions like <code>TABLE[X]</code>, and can be variables, integer or the special <code>X</code> variable that stands for a &quot;generic&quot; index (to define table values as a function of the index). <code>X</code> is contained here in <code>SymbolIndex</code> because there can also be a variable named <code>&quot;X&quot;</code>...</p></div></div><div class="odoc-spec"><div class="spec type" id="type-set_value" class="anchored"><a href="#type-set_value" class="anchor"></a><code><span><span class="keyword">type</span> set_value</span><span> = </span></code><table><tr id="type-set_value.FloatValue" class="anchored"><td class="def variant constructor"><a href="#type-set_value.FloatValue" class="anchor"></a><code><span>| </span><span><span class="constructor">FloatValue</span> <span class="keyword">of</span> <span>float <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td></tr><tr id="type-set_value.VarValue" class="anchored"><td class="def variant constructor"><a href="#type-set_value.VarValue" class="anchor"></a><code><span>| </span><span><span class="constructor">VarValue</span> <span class="keyword">of</span> <span><a href="#type-variable">variable</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td></tr><tr id="type-set_value.Interval" class="anchored"><td class="def variant constructor"><a href="#type-set_value.Interval" class="anchor"></a><code><span>| </span><span><span class="constructor">Interval</span> <span class="keyword">of</span> <span>int <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span>int <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td></tr></table></div></div><h3 id="loops"><a href="#loops" class="anchor"></a>Loops</h3><p>The M language has an extremely odd way to specify looping. Rather than having first-class local mutable variables whose value change at each loop iteration, the M language prefers to use the changing loop parameter to instantiate the variable names inside the loop. For instance,</p><pre>somme(i=1..10:Xi)</pre><p>should evaluate to the sum of variables <code>X1</code>, <code>X2</code>, etc. Parameters can be number or characters and there can be multiple of them. We have to store all this information.</p><div class="odoc-spec"><div class="spec type" id="type-set_value_loop" class="anchored"><a href="#type-set_value_loop" class="anchor"></a><code><span><span class="keyword">type</span> set_value_loop</span><span> = </span></code><table><tr id="type-set_value_loop.Single" class="anchored"><td class="def variant constructor"><a href="#type-set_value_loop.Single" class="anchor"></a><code><span>| </span><span><span class="constructor">Single</span> <span class="keyword">of</span> <span><a href="#type-literal">literal</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td></tr><tr id="type-set_value_loop.Range" class="anchored"><td class="def variant constructor"><a href="#type-set_value_loop.Range" class="anchor"></a><code><span>| </span><span><span class="constructor">Range</span> <span class="keyword">of</span> <span><a href="#type-literal">literal</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><a href="#type-literal">literal</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td></tr><tr id="type-set_value_loop.Interval" class="anchored"><td class="def variant constructor"><a href="#type-set_value_loop.Interval" class="anchor"></a><code><span>| </span><span><span class="constructor">Interval</span> <span class="keyword">of</span> <span><a href="#type-literal">literal</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><a href="#type-literal">literal</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td></tr></table></div><div class="spec-doc"><p>Values that can be substituted for loop parameters</p></div></div><div class="odoc-spec"><div class="spec type" id="type-loop_variable" class="anchored"><a href="#type-loop_variable" class="anchor"></a><code><span><span class="keyword">type</span> loop_variable</span><span> = <span>char <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><a href="#type-set_value_loop">set_value_loop</a> list</span></span></code></div><div class="spec-doc"><p>A loop variable is the character that should be substituted in variable names inside the loop plus the set of value to substitute.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-loop_variables" class="anchored"><a href="#type-loop_variables" class="anchor"></a><code><span><span class="keyword">type</span> loop_variables</span><span> = </span></code><table><tr id="type-loop_variables.ValueSets" class="anchored"><td class="def variant constructor"><a href="#type-loop_variables.ValueSets" class="anchor"></a><code><span>| </span><span><span class="constructor">ValueSets</span> <span class="keyword">of</span> <span><a href="#type-loop_variable">loop_variable</a> list</span></span></code></td></tr><tr id="type-loop_variables.Ranges" class="anchored"><td class="def variant constructor"><a href="#type-loop_variables.Ranges" class="anchor"></a><code><span>| </span><span><span class="constructor">Ranges</span> <span class="keyword">of</span> <span><a href="#type-loop_variable">loop_variable</a> list</span></span></code></td></tr></table></div><div class="spec-doc"><p>There are two kind of loop variables declaration, but they are semantically the same though they have different concrete syntax.</p></div></div><h3 id="expressions"><a href="#expressions" class="anchor"></a>Expressions</h3><div class="odoc-spec"><div class="spec type" id="type-comp_op" class="anchored"><a href="#type-comp_op" class="anchor"></a><code><span><span class="keyword">type</span> comp_op</span><span> = </span></code><table><tr id="type-comp_op.Gt" class="anchored"><td class="def variant constructor"><a href="#type-comp_op.Gt" class="anchor"></a><code><span>| </span><span><span class="constructor">Gt</span></span></code></td></tr><tr id="type-comp_op.Gte" class="anchored"><td class="def variant constructor"><a href="#type-comp_op.Gte" class="anchor"></a><code><span>| </span><span><span class="constructor">Gte</span></span></code></td></tr><tr id="type-comp_op.Lt" class="anchored"><td class="def variant constructor"><a href="#type-comp_op.Lt" class="anchor"></a><code><span>| </span><span><span class="constructor">Lt</span></span></code></td></tr><tr id="type-comp_op.Lte" class="anchored"><td class="def variant constructor"><a href="#type-comp_op.Lte" class="anchor"></a><code><span>| </span><span><span class="constructor">Lte</span></span></code></td></tr><tr id="type-comp_op.Eq" class="anchored"><td class="def variant constructor"><a href="#type-comp_op.Eq" class="anchor"></a><code><span>| </span><span><span class="constructor">Eq</span></span></code></td></tr><tr id="type-comp_op.Neq" class="anchored"><td class="def variant constructor"><a href="#type-comp_op.Neq" class="anchor"></a><code><span>| </span><span><span class="constructor">Neq</span></span></code></td></tr></table></div><div class="spec-doc"><p>Comparison operators</p></div></div><div class="odoc-spec"><div class="spec type" id="type-binop" class="anchored"><a href="#type-binop" class="anchor"></a><code><span><span class="keyword">type</span> binop</span><span> = </span></code><table><tr id="type-binop.And" class="anchored"><td class="def variant constructor"><a href="#type-binop.And" class="anchor"></a><code><span>| </span><span><span class="constructor">And</span></span></code></td></tr><tr id="type-binop.Or" class="anchored"><td class="def variant constructor"><a href="#type-binop.Or" class="anchor"></a><code><span>| </span><span><span class="constructor">Or</span></span></code></td></tr><tr id="type-binop.Add" class="anchored"><td class="def variant constructor"><a href="#type-binop.Add" class="anchor"></a><code><span>| </span><span><span class="constructor">Add</span></span></code></td></tr><tr id="type-binop.Sub" class="anchored"><td class="def variant constructor"><a href="#type-binop.Sub" class="anchor"></a><code><span>| </span><span><span class="constructor">Sub</span></span></code></td></tr><tr id="type-binop.Mul" class="anchored"><td class="def variant constructor"><a href="#type-binop.Mul" class="anchor"></a><code><span>| </span><span><span class="constructor">Mul</span></span></code></td></tr><tr id="type-binop.Div" class="anchored"><td class="def variant constructor"><a href="#type-binop.Div" class="anchor"></a><code><span>| </span><span><span class="constructor">Div</span></span></code></td></tr></table></div><div class="spec-doc"><p>Binary operators</p></div></div><div class="odoc-spec"><div class="spec value" id="val-precedence" class="anchored"><a href="#val-precedence" class="anchor"></a><code><span><span class="keyword">val</span> precedence : <span><a href="#type-binop">binop</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-has_priority" class="anchored"><a href="#val-has_priority" class="anchor"></a><code><span><span class="keyword">val</span> has_priority : <span><a href="#type-binop">binop</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-binop">binop</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-is_right_associative" class="anchored"><a href="#val-is_right_associative" class="anchor"></a><code><span><span class="keyword">val</span> is_right_associative : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-is_left_associative" class="anchored"><a href="#val-is_left_associative" class="anchor"></a><code><span><span class="keyword">val</span> is_left_associative : <span><a href="#type-binop">binop</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-unop" class="anchored"><a href="#type-unop" class="anchor"></a><code><span><span class="keyword">type</span> unop</span><span> = </span></code><table><tr id="type-unop.Not" class="anchored"><td class="def variant constructor"><a href="#type-unop.Not" class="anchor"></a><code><span>| </span><span><span class="constructor">Not</span></span></code></td></tr><tr id="type-unop.Minus" class="anchored"><td class="def variant constructor"><a href="#type-unop.Minus" class="anchor"></a><code><span>| </span><span><span class="constructor">Minus</span></span></code></td></tr></table></div><div class="spec-doc"><p>Unary operators</p></div></div><div class="odoc-spec"><div class="spec type" id="type-expression" class="anchored"><a href="#type-expression" class="anchor"></a><code><span><span class="keyword">type</span> expression</span><span> = </span></code><table><tr id="type-expression.TestInSet" class="anchored"><td class="def variant constructor"><a href="#type-expression.TestInSet" class="anchor"></a><code><span>| </span><span><span class="constructor">TestInSet</span> <span class="keyword">of</span> bool * <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><a href="#type-set_value">set_value</a> list</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Test if an expression is in a set of value (or not in the set if the flag is set to <code>false</code>)</p><span class="comment-delim">*)</span></td></tr><tr id="type-expression.Comparison" class="anchored"><td class="def variant constructor"><a href="#type-expression.Comparison" class="anchor"></a><code><span>| </span><span><span class="constructor">Comparison</span> <span class="keyword">of</span> <span><a href="#type-comp_op">comp_op</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>
  * <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>
  * <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Compares two expressions and produce a boolean</p><span class="comment-delim">*)</span></td></tr><tr id="type-expression.Binop" class="anchored"><td class="def variant constructor"><a href="#type-expression.Binop" class="anchor"></a><code><span>| </span><span><span class="constructor">Binop</span> <span class="keyword">of</span> <span><a href="#type-binop">binop</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td></tr><tr id="type-expression.Unop" class="anchored"><td class="def variant constructor"><a href="#type-expression.Unop" class="anchor"></a><code><span>| </span><span><span class="constructor">Unop</span> <span class="keyword">of</span> <a href="#type-unop">unop</a> * <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td></tr><tr id="type-expression.Index" class="anchored"><td class="def variant constructor"><a href="#type-expression.Index" class="anchor"></a><code><span>| </span><span><span class="constructor">Index</span> <span class="keyword">of</span> <span><a href="#type-variable">variable</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><a href="#type-table_index">table_index</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Access a cell in a table</p><span class="comment-delim">*)</span></td></tr><tr id="type-expression.Conditional" class="anchored"><td class="def variant constructor"><a href="#type-expression.Conditional" class="anchor"></a><code><span>| </span><span><span class="constructor">Conditional</span> <span class="keyword">of</span> <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>
  * <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>
  * <span><span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> option</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Classic conditional with an optional else clause (<code>None</code> only for verification conditions)</p><span class="comment-delim">*)</span></td></tr><tr id="type-expression.FunctionCall" class="anchored"><td class="def variant constructor"><a href="#type-expression.FunctionCall" class="anchor"></a><code><span>| </span><span><span class="constructor">FunctionCall</span> <span class="keyword">of</span> <span><a href="#type-func_name">func_name</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <a href="#type-func_args">func_args</a></span></code></td></tr><tr id="type-expression.Literal" class="anchored"><td class="def variant constructor"><a href="#type-expression.Literal" class="anchor"></a><code><span>| </span><span><span class="constructor">Literal</span> <span class="keyword">of</span> <a href="#type-literal">literal</a></span></code></td></tr><tr id="type-expression.Loop" class="anchored"><td class="def variant constructor"><a href="#type-expression.Loop" class="anchor"></a><code><span>| </span><span><span class="constructor">Loop</span> <span class="keyword">of</span> <span><a href="#type-loop_variables">loop_variables</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The loop is prefixed with the loop variables declarations</p><span class="comment-delim">*)</span></td></tr></table></div><div class="spec-doc"><p>The main type of the M language</p></div></div><div class="odoc-spec"><div class="spec type" id="type-func_args" class="anchored"><a href="#type-func_args" class="anchor"></a><code><span><span class="keyword">and</span> func_args</span><span> = </span></code><table><tr id="type-func_args.ArgList" class="anchored"><td class="def variant constructor"><a href="#type-func_args.ArgList" class="anchor"></a><code><span>| </span><span><span class="constructor">ArgList</span> <span class="keyword">of</span> <span><span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span></span></code></td></tr><tr id="type-func_args.LoopList" class="anchored"><td class="def variant constructor"><a href="#type-func_args.LoopList" class="anchor"></a><code><span>| </span><span><span class="constructor">LoopList</span> <span class="keyword">of</span> <span><a href="#type-loop_variables">loop_variables</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td></tr></table></div><div class="spec-doc"><p>Functions can take a explicit list of argument or a loop expression that expands into a list</p></div></div><h2 id="toplevel-clauses"><a href="#toplevel-clauses" class="anchor"></a>Toplevel clauses</h2><h3 id="rules"><a href="#rules" class="anchor"></a>Rules</h3><p>The rule is the main feature of the M language. It defines the expression of one or several variables.</p><div class="odoc-spec"><div class="spec type" id="type-lvalue" class="anchored"><a href="#type-lvalue" class="anchor"></a><code><span><span class="keyword">type</span> lvalue</span><span> = </span><span>{</span></code><table><tr id="type-lvalue.var" class="anchored"><td class="def record field"><a href="#type-lvalue.var" class="anchor"></a><code><span>var : <span><a href="#type-variable">variable</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr><tr id="type-lvalue.index" class="anchored"><td class="def record field"><a href="#type-lvalue.index" class="anchor"></a><code><span>index : <span><span><a href="#type-table_index">table_index</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> option</span>;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>An lvalue (left value) is a variable being assigned. It can be a table or a non-table variable</p></div></div><div class="odoc-spec"><div class="spec type" id="type-formula_decl" class="anchored"><a href="#type-formula_decl" class="anchor"></a><code><span><span class="keyword">type</span> formula_decl</span><span> = </span><span>{</span></code><table><tr id="type-formula_decl.lvalue" class="anchored"><td class="def record field"><a href="#type-formula_decl.lvalue" class="anchor"></a><code><span>lvalue : <span><a href="#type-lvalue">lvalue</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr><tr id="type-formula_decl.formula" class="anchored"><td class="def record field"><a href="#type-formula_decl.formula" class="anchor"></a><code><span>formula : <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-formula" class="anchored"><a href="#type-formula" class="anchor"></a><code><span><span class="keyword">type</span> formula</span><span> = </span></code><table><tr id="type-formula.SingleFormula" class="anchored"><td class="def variant constructor"><a href="#type-formula.SingleFormula" class="anchor"></a><code><span>| </span><span><span class="constructor">SingleFormula</span> <span class="keyword">of</span> <a href="#type-formula_decl">formula_decl</a></span></code></td></tr><tr id="type-formula.MultipleFormulaes" class="anchored"><td class="def variant constructor"><a href="#type-formula.MultipleFormulaes" class="anchor"></a><code><span>| </span><span><span class="constructor">MultipleFormulaes</span> <span class="keyword">of</span> <span><a href="#type-loop_variables">loop_variables</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <a href="#type-formula_decl">formula_decl</a></span></code></td></tr></table></div><div class="spec-doc"><p>In the M language, you can define multiple variables at once. This is the way they do looping since the definition can depend on the loop variable value (e.g <code>Xi</code> can depend on <code>i</code>).</p></div></div><div class="odoc-spec"><div class="spec type" id="type-rule" class="anchored"><a href="#type-rule" class="anchor"></a><code><span><span class="keyword">type</span> rule</span><span> = </span><span>{</span></code><table><tr id="type-rule.rule_number" class="anchored"><td class="def record field"><a href="#type-rule.rule_number" class="anchor"></a><code><span>rule_number : <span>int <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr><tr id="type-rule.rule_tag_names" class="anchored"><td class="def record field"><a href="#type-rule.rule_tag_names" class="anchor"></a><code><span>rule_tag_names : <span><span><span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr><tr id="type-rule.rule_applications" class="anchored"><td class="def record field"><a href="#type-rule.rule_applications" class="anchor"></a><code><span>rule_applications : <span><span><a href="#type-application">application</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td></tr><tr id="type-rule.rule_chaining" class="anchored"><td class="def record field"><a href="#type-rule.rule_chaining" class="anchor"></a><code><span>rule_chaining : <span><span><a href="#type-chaining">chaining</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> option</span>;</span></code></td></tr><tr id="type-rule.rule_formulaes" class="anchored"><td class="def record field"><a href="#type-rule.rule_formulaes" class="anchor"></a><code><span>rule_formulaes : <span><span><a href="#type-formula">formula</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>A rule can contain many variable definitions</p><span class="comment-delim">*)</span></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-domain_decl" class="anchored"><a href="#type-domain_decl" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a domain_decl</span></span><span> = </span><span>{</span></code><table><tr id="type-domain_decl.dom_names" class="anchored"><td class="def record field"><a href="#type-domain_decl.dom_names" class="anchor"></a><code><span>dom_names : <span><span><span><span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td></tr><tr id="type-domain_decl.dom_parents" class="anchored"><td class="def record field"><a href="#type-domain_decl.dom_parents" class="anchor"></a><code><span>dom_parents : <span><span><span><span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td></tr><tr id="type-domain_decl.dom_by_default" class="anchored"><td class="def record field"><a href="#type-domain_decl.dom_by_default" class="anchor"></a><code><span>dom_by_default : bool;</span></code></td></tr><tr id="type-domain_decl.dom_data" class="anchored"><td class="def record field"><a href="#type-domain_decl.dom_data" class="anchor"></a><code><span>dom_data : <span class="type-var">'a</span>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-rule_domain_data" class="anchored"><a href="#type-rule_domain_data" class="anchor"></a><code><span><span class="keyword">type</span> rule_domain_data</span><span> = </span><span>{</span></code><table><tr id="type-rule_domain_data.rdom_computable" class="anchored"><td class="def record field"><a href="#type-rule_domain_data.rdom_computable" class="anchor"></a><code><span>rdom_computable : bool;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-rule_domain_decl" class="anchored"><a href="#type-rule_domain_decl" class="anchor"></a><code><span><span class="keyword">type</span> rule_domain_decl</span><span> = <span><a href="#type-rule_domain_data">rule_domain_data</a> <a href="#type-domain_decl">domain_decl</a></span></span></code></div></div><h3 id="variable-declaration"><a href="#variable-declaration" class="anchor"></a>Variable declaration</h3><p>The M language has prototypes for declaring variables with types and various attributes. There are three kind of variables: input variables, computed variables and constant variables.</p><p>Variable declaration is not application-specific, which is not coherent.</p><h4 id="input-variables"><a href="#input-variables" class="anchor"></a>Input variables</h4><div class="odoc-spec"><div class="spec type" id="type-variable_attribute" class="anchored"><a href="#type-variable_attribute" class="anchor"></a><code><span><span class="keyword">type</span> variable_attribute</span><span> = <span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><a href="#type-literal">literal</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-value_typ" class="anchored"><a href="#type-value_typ" class="anchor"></a><code><span><span class="keyword">type</span> value_typ</span><span> = </span></code><table><tr id="type-value_typ.Boolean" class="anchored"><td class="def variant constructor"><a href="#type-value_typ.Boolean" class="anchor"></a><code><span>| </span><span><span class="constructor">Boolean</span></span></code></td></tr><tr id="type-value_typ.DateYear" class="anchored"><td class="def variant constructor"><a href="#type-value_typ.DateYear" class="anchor"></a><code><span>| </span><span><span class="constructor">DateYear</span></span></code></td></tr><tr id="type-value_typ.DateDayMonthYear" class="anchored"><td class="def variant constructor"><a href="#type-value_typ.DateDayMonthYear" class="anchor"></a><code><span>| </span><span><span class="constructor">DateDayMonthYear</span></span></code></td></tr><tr id="type-value_typ.DateMonth" class="anchored"><td class="def variant constructor"><a href="#type-value_typ.DateMonth" class="anchor"></a><code><span>| </span><span><span class="constructor">DateMonth</span></span></code></td></tr><tr id="type-value_typ.Integer" class="anchored"><td class="def variant constructor"><a href="#type-value_typ.Integer" class="anchor"></a><code><span>| </span><span><span class="constructor">Integer</span></span></code></td></tr><tr id="type-value_typ.Real" class="anchored"><td class="def variant constructor"><a href="#type-value_typ.Real" class="anchor"></a><code><span>| </span><span><span class="constructor">Real</span></span></code></td></tr></table></div><div class="spec-doc"><p>Here are all the types a value can have. Date types don't seem to be used at all though.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-input_variable" class="anchored"><a href="#type-input_variable" class="anchor"></a><code><span><span class="keyword">type</span> input_variable</span><span> = </span><span>{</span></code><table><tr id="type-input_variable.input_name" class="anchored"><td class="def record field"><a href="#type-input_variable.input_name" class="anchor"></a><code><span>input_name : <span><a href="#type-variable_name">variable_name</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr><tr id="type-input_variable.input_category" class="anchored"><td class="def record field"><a href="#type-input_variable.input_category" class="anchor"></a><code><span>input_category : <span><span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td></tr><tr id="type-input_variable.input_attributes" class="anchored"><td class="def record field"><a href="#type-input_variable.input_attributes" class="anchor"></a><code><span>input_attributes : <span><a href="#type-variable_attribute">variable_attribute</a> list</span>;</span></code></td></tr><tr id="type-input_variable.input_alias" class="anchored"><td class="def record field"><a href="#type-input_variable.input_alias" class="anchor"></a><code><span>input_alias : <span><a href="#type-variable_name">variable_name</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Unused for now</p><span class="comment-delim">*)</span></td></tr><tr id="type-input_variable.input_is_givenback" class="anchored"><td class="def record field"><a href="#type-input_variable.input_is_givenback" class="anchor"></a><code><span>input_is_givenback : bool;</span></code></td></tr><tr id="type-input_variable.input_description" class="anchored"><td class="def record field"><a href="#type-input_variable.input_description" class="anchor"></a><code><span>input_description : <span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr><tr id="type-input_variable.input_typ" class="anchored"><td class="def record field"><a href="#type-input_variable.input_typ" class="anchor"></a><code><span>input_typ : <span><span><a href="#type-value_typ">value_typ</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> option</span>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-computed_variable" class="anchored"><a href="#type-computed_variable" class="anchor"></a><code><span><span class="keyword">type</span> computed_variable</span><span> = </span><span>{</span></code><table><tr id="type-computed_variable.comp_name" class="anchored"><td class="def record field"><a href="#type-computed_variable.comp_name" class="anchor"></a><code><span>comp_name : <span><a href="#type-variable_name">variable_name</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr><tr id="type-computed_variable.comp_table" class="anchored"><td class="def record field"><a href="#type-computed_variable.comp_table" class="anchor"></a><code><span>comp_table : <span><span>int <a href="../Pos/index.html#type-marked">Pos.marked</a></span> option</span>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>size of the table, <code>None</code> for non-table variables</p><span class="comment-delim">*)</span></td></tr><tr id="type-computed_variable.comp_attributes" class="anchored"><td class="def record field"><a href="#type-computed_variable.comp_attributes" class="anchor"></a><code><span>comp_attributes : <span><a href="#type-variable_attribute">variable_attribute</a> list</span>;</span></code></td></tr><tr id="type-computed_variable.comp_category" class="anchored"><td class="def record field"><a href="#type-computed_variable.comp_category" class="anchor"></a><code><span>comp_category : <span><span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td></tr><tr id="type-computed_variable.comp_typ" class="anchored"><td class="def record field"><a href="#type-computed_variable.comp_typ" class="anchor"></a><code><span>comp_typ : <span><span><a href="#type-value_typ">value_typ</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> option</span>;</span></code></td></tr><tr id="type-computed_variable.comp_is_givenback" class="anchored"><td class="def record field"><a href="#type-computed_variable.comp_is_givenback" class="anchor"></a><code><span>comp_is_givenback : bool;</span></code></td></tr><tr id="type-computed_variable.comp_description" class="anchored"><td class="def record field"><a href="#type-computed_variable.comp_description" class="anchor"></a><code><span>comp_description : <span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-variable_decl" class="anchored"><a href="#type-variable_decl" class="anchor"></a><code><span><span class="keyword">type</span> variable_decl</span><span> = </span></code><table><tr id="type-variable_decl.ComputedVar" class="anchored"><td class="def variant constructor"><a href="#type-variable_decl.ComputedVar" class="anchor"></a><code><span>| </span><span><span class="constructor">ComputedVar</span> <span class="keyword">of</span> <span><a href="#type-computed_variable">computed_variable</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td></tr><tr id="type-variable_decl.ConstVar" class="anchored"><td class="def variant constructor"><a href="#type-variable_decl.ConstVar" class="anchor"></a><code><span>| </span><span><span class="constructor">ConstVar</span> <span class="keyword">of</span> <span><a href="#type-variable_name">variable_name</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><a href="#type-literal">literal</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The literal is the constant value</p><span class="comment-delim">*)</span></td></tr><tr id="type-variable_decl.InputVar" class="anchored"><td class="def variant constructor"><a href="#type-variable_decl.InputVar" class="anchor"></a><code><span>| </span><span><span class="constructor">InputVar</span> <span class="keyword">of</span> <span><a href="#type-input_variable">input_variable</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec type" id="type-var_type" class="anchored"><a href="#type-var_type" class="anchor"></a><code><span><span class="keyword">type</span> var_type</span><span> = </span></code><table><tr id="type-var_type.Input" class="anchored"><td class="def variant constructor"><a href="#type-var_type.Input" class="anchor"></a><code><span>| </span><span><span class="constructor">Input</span></span></code></td></tr><tr id="type-var_type.Computed" class="anchored"><td class="def variant constructor"><a href="#type-var_type.Computed" class="anchor"></a><code><span>| </span><span><span class="constructor">Computed</span></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec type" id="type-var_category_decl" class="anchored"><a href="#type-var_category_decl" class="anchor"></a><code><span><span class="keyword">type</span> var_category_decl</span><span> = </span><span>{</span></code><table><tr id="type-var_category_decl.var_type" class="anchored"><td class="def record field"><a href="#type-var_category_decl.var_type" class="anchor"></a><code><span>var_type : <a href="#type-var_type">var_type</a>;</span></code></td></tr><tr id="type-var_category_decl.var_category" class="anchored"><td class="def record field"><a href="#type-var_category_decl.var_category" class="anchor"></a><code><span>var_category : <span><span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td></tr><tr id="type-var_category_decl.var_attributes" class="anchored"><td class="def record field"><a href="#type-var_category_decl.var_attributes" class="anchor"></a><code><span>var_attributes : <span><span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-input_category" class="anchored"><a href="#val-input_category" class="anchor"></a><code><span><span class="keyword">val</span> input_category : string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-computed_category" class="anchored"><a href="#val-computed_category" class="anchor"></a><code><span><span class="keyword">val</span> computed_category : string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-base_category" class="anchored"><a href="#val-base_category" class="anchor"></a><code><span><span class="keyword">val</span> base_category : string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-givenback_category" class="anchored"><a href="#val-givenback_category" class="anchor"></a><code><span><span class="keyword">val</span> givenback_category : string</span></code></div></div><h3 id="verification-clauses"><a href="#verification-clauses" class="anchor"></a>Verification clauses</h3><p>These clauses are expression refering to the variables of the program. They seem to be dynamically checked and trigger errors when false.</p><div class="odoc-spec"><div class="spec type" id="type-verification_condition" class="anchored"><a href="#type-verification_condition" class="anchor"></a><code><span><span class="keyword">type</span> verification_condition</span><span> = </span><span>{</span></code><table><tr id="type-verification_condition.verif_cond_expr" class="anchored"><td class="def record field"><a href="#type-verification_condition.verif_cond_expr" class="anchor"></a><code><span>verif_cond_expr : <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr><tr id="type-verification_condition.verif_cond_error" class="anchored"><td class="def record field"><a href="#type-verification_condition.verif_cond_error" class="anchor"></a><code><span>verif_cond_error : <span><a href="#type-error_name">error_name</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><span><a href="#type-variable_name">variable_name</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> option</span>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>A verification condition error can ba associated to a variable</p><span class="comment-delim">*)</span></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-verification" class="anchored"><a href="#type-verification" class="anchor"></a><code><span><span class="keyword">type</span> verification</span><span> = </span><span>{</span></code><table><tr id="type-verification.verif_number" class="anchored"><td class="def record field"><a href="#type-verification.verif_number" class="anchor"></a><code><span>verif_number : <span>int <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr><tr id="type-verification.verif_tag_names" class="anchored"><td class="def record field"><a href="#type-verification.verif_tag_names" class="anchor"></a><code><span>verif_tag_names : <span><span><span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr><tr id="type-verification.verif_applications" class="anchored"><td class="def record field"><a href="#type-verification.verif_applications" class="anchor"></a><code><span>verif_applications : <span><span><a href="#type-application">application</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Verification conditions are application-specific</p><span class="comment-delim">*)</span></td></tr><tr id="type-verification.verif_conditions" class="anchored"><td class="def record field"><a href="#type-verification.verif_conditions" class="anchor"></a><code><span>verif_conditions : <span><span><a href="#type-verification_condition">verification_condition</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-verif_auth_decl" class="anchored"><a href="#type-verif_auth_decl" class="anchor"></a><code><span><span class="keyword">type</span> verif_auth_decl</span><span> = <span><span><span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-verif_domain_data" class="anchored"><a href="#type-verif_domain_data" class="anchor"></a><code><span><span class="keyword">type</span> verif_domain_data</span><span> = </span><span>{</span></code><table><tr id="type-verif_domain_data.vdom_auth" class="anchored"><td class="def record field"><a href="#type-verif_domain_data.vdom_auth" class="anchor"></a><code><span>vdom_auth : <span><a href="#type-verif_auth_decl">verif_auth_decl</a> list</span>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-verif_domain_decl" class="anchored"><a href="#type-verif_domain_decl" class="anchor"></a><code><span><span class="keyword">type</span> verif_domain_decl</span><span> = <span><a href="#type-verif_domain_data">verif_domain_data</a> <a href="#type-domain_decl">domain_decl</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-error_typ" class="anchored"><a href="#type-error_typ" class="anchor"></a><code><span><span class="keyword">type</span> error_typ</span><span> = </span></code><table><tr id="type-error_typ.Anomaly" class="anchored"><td class="def variant constructor"><a href="#type-error_typ.Anomaly" class="anchor"></a><code><span>| </span><span><span class="constructor">Anomaly</span></span></code></td></tr><tr id="type-error_typ.Discordance" class="anchored"><td class="def variant constructor"><a href="#type-error_typ.Discordance" class="anchor"></a><code><span>| </span><span><span class="constructor">Discordance</span></span></code></td></tr><tr id="type-error_typ.Information" class="anchored"><td class="def variant constructor"><a href="#type-error_typ.Information" class="anchor"></a><code><span>| </span><span><span class="constructor">Information</span></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-compare_error_type" class="anchored"><a href="#val-compare_error_type" class="anchor"></a><code><span><span class="keyword">val</span> compare_error_type : <span><a href="#type-error_typ">error_typ</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-error_typ">error_typ</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-error_" class="anchored"><a href="#type-error_" class="anchor"></a><code><span><span class="keyword">type</span> error_</span><span> = </span><span>{</span></code><table><tr id="type-error_.error_name" class="anchored"><td class="def record field"><a href="#type-error_.error_name" class="anchor"></a><code><span>error_name : <span><a href="#type-error_name">error_name</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr><tr id="type-error_.error_typ" class="anchored"><td class="def record field"><a href="#type-error_.error_typ" class="anchor"></a><code><span>error_typ : <span><a href="#type-error_typ">error_typ</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>;</span></code></td></tr><tr id="type-error_.error_descr" class="anchored"><td class="def record field"><a href="#type-error_.error_descr" class="anchor"></a><code><span>error_descr : <span><span>string <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td></tr></table><code><span>}</span></code></div></div><h2 id="m-programs"><a href="#m-programs" class="anchor"></a>M programs</h2><div class="odoc-spec"><div class="spec type" id="type-source_file_item" class="anchored"><a href="#type-source_file_item" class="anchor"></a><code><span><span class="keyword">type</span> source_file_item</span><span> = </span></code><table><tr id="type-source_file_item.Application" class="anchored"><td class="def variant constructor"><a href="#type-source_file_item.Application" class="anchor"></a><code><span>| </span><span><span class="constructor">Application</span> <span class="keyword">of</span> <span><a href="#type-application">application</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Declares an application</p><span class="comment-delim">*)</span></td></tr><tr id="type-source_file_item.Chaining" class="anchored"><td class="def variant constructor"><a href="#type-source_file_item.Chaining" class="anchor"></a><code><span>| </span><span><span class="constructor">Chaining</span> <span class="keyword">of</span> <a href="#type-chaining">chaining</a> * <span><span><a href="#type-application">application</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Unused, declares an &quot;enchaineur&quot;</p><span class="comment-delim">*)</span></td></tr><tr id="type-source_file_item.VariableDecl" class="anchored"><td class="def variant constructor"><a href="#type-source_file_item.VariableDecl" class="anchor"></a><code><span>| </span><span><span class="constructor">VariableDecl</span> <span class="keyword">of</span> <a href="#type-variable_decl">variable_decl</a></span></code></td></tr><tr id="type-source_file_item.Rule" class="anchored"><td class="def variant constructor"><a href="#type-source_file_item.Rule" class="anchor"></a><code><span>| </span><span><span class="constructor">Rule</span> <span class="keyword">of</span> <a href="#type-rule">rule</a></span></code></td></tr><tr id="type-source_file_item.Verification" class="anchored"><td class="def variant constructor"><a href="#type-source_file_item.Verification" class="anchor"></a><code><span>| </span><span><span class="constructor">Verification</span> <span class="keyword">of</span> <a href="#type-verification">verification</a></span></code></td></tr><tr id="type-source_file_item.Error" class="anchored"><td class="def variant constructor"><a href="#type-source_file_item.Error" class="anchor"></a><code><span>| </span><span><span class="constructor">Error</span> <span class="keyword">of</span> <a href="#type-error_">error_</a></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Declares an error</p><span class="comment-delim">*)</span></td></tr><tr id="type-source_file_item.Output" class="anchored"><td class="def variant constructor"><a href="#type-source_file_item.Output" class="anchor"></a><code><span>| </span><span><span class="constructor">Output</span> <span class="keyword">of</span> <span><a href="#type-variable_name">variable_name</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Declares an output variable</p><span class="comment-delim">*)</span></td></tr><tr id="type-source_file_item.Function" class="anchored"><td class="def variant constructor"><a href="#type-source_file_item.Function" class="anchor"></a><code><span>| </span><span><span class="constructor">Function</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Declares a function, unused</p><span class="comment-delim">*)</span></td></tr><tr id="type-source_file_item.VarCatDecl" class="anchored"><td class="def variant constructor"><a href="#type-source_file_item.VarCatDecl" class="anchor"></a><code><span>| </span><span><span class="constructor">VarCatDecl</span> <span class="keyword">of</span> <span><a href="#type-var_category_decl">var_category_decl</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span></span></code></td></tr><tr id="type-source_file_item.RuleDomDecl" class="anchored"><td class="def variant constructor"><a href="#type-source_file_item.RuleDomDecl" class="anchor"></a><code><span>| </span><span><span class="constructor">RuleDomDecl</span> <span class="keyword">of</span> <a href="#type-rule_domain_decl">rule_domain_decl</a></span></code></td></tr><tr id="type-source_file_item.VerifDomDecl" class="anchored"><td class="def variant constructor"><a href="#type-source_file_item.VerifDomDecl" class="anchor"></a><code><span>| </span><span><span class="constructor">VerifDomDecl</span> <span class="keyword">of</span> <a href="#type-verif_domain_decl">verif_domain_decl</a></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec type" id="type-source_file" class="anchored"><a href="#type-source_file" class="anchor"></a><code><span><span class="keyword">type</span> source_file</span><span> = <span><span><a href="#type-source_file_item">source_file_item</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-program" class="anchored"><a href="#type-program" class="anchor"></a><code><span><span class="keyword">type</span> program</span><span> = <span><a href="#type-source_file">source_file</a> list</span></span></code></div></div><h2 id="function-specification-ast"><a href="#function-specification-ast" class="anchor"></a>Function specification AST</h2><div class="odoc-spec"><div class="spec type" id="type-function_spec" class="anchored"><a href="#type-function_spec" class="anchor"></a><code><span><span class="keyword">type</span> function_spec</span><span> = </span><span>{</span></code><table><tr id="type-function_spec.spec_inputs" class="anchored"><td class="def record field"><a href="#type-function_spec.spec_inputs" class="anchor"></a><code><span>spec_inputs : <span><span><a href="#type-variable_name">variable_name</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td></tr><tr id="type-function_spec.spec_consts" class="anchored"><td class="def record field"><a href="#type-function_spec.spec_consts" class="anchor"></a><code><span>spec_consts : <span><span>(<span><a href="#type-variable_name">variable_name</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> * <span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span>)</span> list</span>;</span></code></td></tr><tr id="type-function_spec.spec_outputs" class="anchored"><td class="def record field"><a href="#type-function_spec.spec_outputs" class="anchor"></a><code><span>spec_outputs : <span><span><a href="#type-variable_name">variable_name</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td></tr><tr id="type-function_spec.spec_conditions" class="anchored"><td class="def record field"><a href="#type-function_spec.spec_conditions" class="anchor"></a><code><span>spec_conditions : <span><span><a href="#type-expression">expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> list</span>;</span></code></td></tr></table><code><span>}</span></code></div></div><h2 id="helper-functions"><a href="#helper-functions" class="anchor"></a>Helper functions</h2><div class="odoc-spec"><div class="spec value" id="val-get_variable_name" class="anchored"><a href="#val-get_variable_name" class="anchor"></a><code><span><span class="keyword">val</span> get_variable_name : <span><a href="#type-variable">variable</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div></div></body></html>