<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Bir_interpreter (mlang.Mlang.Bir_interpreter)</title><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">mlang</a> &#x00BB; <a href="../index.html">Mlang</a> &#x00BB; Bir_interpreter</nav><header class="odoc-preamble"><h1>Module <code><span>Mlang.Bir_interpreter</span></code></h1><p>Interpretation of BIR programs</p></header><nav class="odoc-toc"><ul><li><a href="#program-values">Program values</a></li><li><a href="#instrumentation-of-the-interpreter">Instrumentation of the interpreter</a></li><li><a href="#the-interpreter-functor">The interpreter functor</a></li><li><a href="#generic-interpretation-api">Generic interpretation API</a></li></ul></nav><div class="odoc-content"><h2 id="program-values"><a href="#program-values" class="anchor"></a>Program values</h2><div class="odoc-spec"><div class="spec type" id="type-var_literal" class="anchored"><a href="#type-var_literal" class="anchor"></a><code><span><span class="keyword">type</span> var_literal</span><span> = </span></code><table><tr id="type-var_literal.SimpleVar" class="anchored"><td class="def variant constructor"><a href="#type-var_literal.SimpleVar" class="anchor"></a><code><span>| </span><span><span class="constructor">SimpleVar</span> <span class="keyword">of</span> <a href="../Mir/index.html#type-literal">Mir.literal</a></span></code></td></tr><tr id="type-var_literal.TableVar" class="anchored"><td class="def variant constructor"><a href="#type-var_literal.TableVar" class="anchor"></a><code><span>| </span><span><span class="constructor">TableVar</span> <span class="keyword">of</span> int * <span><a href="../Mir/index.html#type-literal">Mir.literal</a> array</span></span></code></td></tr></table></div></div><h2 id="instrumentation-of-the-interpreter"><a href="#instrumentation-of-the-interpreter" class="anchor"></a>Instrumentation of the interpreter</h2><p>The BIR interpreter can be instrumented to record which program locations have been executed.</p><div class="odoc-spec"><div class="spec type" id="type-code_location_segment" class="anchored"><a href="#type-code_location_segment" class="anchor"></a><code><span><span class="keyword">type</span> code_location_segment</span><span> = </span></code><table><tr id="type-code_location_segment.InsideBlock" class="anchored"><td class="def variant constructor"><a href="#type-code_location_segment.InsideBlock" class="anchor"></a><code><span>| </span><span><span class="constructor">InsideBlock</span> <span class="keyword">of</span> int</span></code></td></tr><tr id="type-code_location_segment.ConditionalBranch" class="anchored"><td class="def variant constructor"><a href="#type-code_location_segment.ConditionalBranch" class="anchor"></a><code><span>| </span><span><span class="constructor">ConditionalBranch</span> <span class="keyword">of</span> bool</span></code></td></tr><tr id="type-code_location_segment.InsideRule" class="anchored"><td class="def variant constructor"><a href="#type-code_location_segment.InsideRule" class="anchor"></a><code><span>| </span><span><span class="constructor">InsideRule</span> <span class="keyword">of</span> <a href="../Bir/index.html#type-rov_id">Bir.rov_id</a></span></code></td></tr><tr id="type-code_location_segment.InsideFunction" class="anchored"><td class="def variant constructor"><a href="#type-code_location_segment.InsideFunction" class="anchor"></a><code><span>| </span><span><span class="constructor">InsideFunction</span> <span class="keyword">of</span> <a href="../Bir/index.html#type-function_name">Bir.function_name</a></span></code></td></tr></table></div><div class="spec-doc"><p>Representation of each program location segment</p></div></div><div class="odoc-spec"><div class="spec value" id="val-format_code_location_segment" class="anchored"><a href="#val-format_code_location_segment" class="anchor"></a><code><span><span class="keyword">val</span> format_code_location_segment : 
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-code_location_segment">code_location_segment</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-code_location" class="anchored"><a href="#type-code_location" class="anchor"></a><code><span><span class="keyword">type</span> code_location</span><span> = <span><a href="#type-code_location_segment">code_location_segment</a> list</span></span></code></div><div class="spec-doc"><p>A program location is simply the path inside the program</p></div></div><div class="odoc-spec"><div class="spec value" id="val-format_code_location" class="anchored"><a href="#val-format_code_location" class="anchor"></a><code><span><span class="keyword">val</span> format_code_location : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-code_location">code_location</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-assign_hook" class="anchored"><a href="#val-assign_hook" class="anchor"></a><code><span><span class="keyword">val</span> assign_hook : 
  <span><span>( <span><a href="../Bir/index.html#type-variable">Bir.variable</a> <span class="arrow">&#45;&gt;</span></span>
    <span><span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-var_literal">var_literal</a> )</span> <span class="arrow">&#45;&gt;</span></span>
    <span><a href="#type-code_location">code_location</a> <span class="arrow">&#45;&gt;</span></span>
    unit )</span>
    <span class="xref-unresolved">Stdlib</span>.ref</span></span></code></div><div class="spec-doc"><p>The instrumentation of the interpreter is done through this reference. The function that you assign to this reference will be called each time a variable assignment is executed</p></div></div><div class="odoc-spec"><div class="spec value" id="val-exit_on_rte" class="anchored"><a href="#val-exit_on_rte" class="anchor"></a><code><span><span class="keyword">val</span> exit_on_rte : <span>bool <span class="xref-unresolved">Stdlib</span>.ref</span></span></code></div><div class="spec-doc"><p>If set to true, the interpreter exits the whole process in case of runtime error</p></div></div><div class="odoc-spec"><div class="spec value" id="val-repl_debug" class="anchored"><a href="#val-repl_debug" class="anchor"></a><code><span><span class="keyword">val</span> repl_debug : <span>bool <span class="xref-unresolved">Stdlib</span>.ref</span></span></code></div><div class="spec-doc"><p>If set to true, prints the REPL debugger in case of runtime error</p></div></div><h2 id="the-interpreter-functor"><a href="#the-interpreter-functor" class="anchor"></a>The interpreter functor</h2><p>The intepreter is parametrized by the kind of floating-point values used for the execution</p><div class="odoc-spec"><div class="spec module-type" id="module-type-S" class="anchored"><a href="#module-type-S" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-S/index.html">S</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Signature of the modules produced by the functor</p></div></div><div class="odoc-spec"><div class="spec module" id="module-FloatDefInterp" class="anchored"><a href="#module-FloatDefInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="FloatDefInterp/index.html">FloatDefInterp</a></span><span> : 
  <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-S/index.html#type-custom_float">custom_float</a> = <a href="../Bir_number/RegularFloatNumber/index.html#type-t">Bir_number.RegularFloatNumber.t</a></span></span></code></div><div class="spec-doc"><p>The different interpreters, which combine a representation of numbers and rounding operations. The first part of the name corresponds to the representation of numbers, and is one of the following:</p></div></div><div class="odoc-spec"><div class="spec module" id="module-FloatMultInterp" class="anchored"><a href="#module-FloatMultInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="FloatMultInterp/index.html">FloatMultInterp</a></span><span> : 
  <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-S/index.html#type-custom_float">custom_float</a> = <a href="../Bir_number/RegularFloatNumber/index.html#type-t">Bir_number.RegularFloatNumber.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-FloatMfInterp" class="anchored"><a href="#module-FloatMfInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="FloatMfInterp/index.html">FloatMfInterp</a></span><span> : 
  <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-S/index.html#type-custom_float">custom_float</a> = <a href="../Bir_number/RegularFloatNumber/index.html#type-t">Bir_number.RegularFloatNumber.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-MPFRDefInterp" class="anchored"><a href="#module-MPFRDefInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="MPFRDefInterp/index.html">MPFRDefInterp</a></span><span> : <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-S/index.html#type-custom_float">custom_float</a> = <a href="../Bir_number/MPFRNumber/index.html#type-t">Bir_number.MPFRNumber.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-MPFRMultInterp" class="anchored"><a href="#module-MPFRMultInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="MPFRMultInterp/index.html">MPFRMultInterp</a></span><span> : <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-S/index.html#type-custom_float">custom_float</a> = <a href="../Bir_number/MPFRNumber/index.html#type-t">Bir_number.MPFRNumber.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-MPFRMfInterp" class="anchored"><a href="#module-MPFRMfInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="MPFRMfInterp/index.html">MPFRMfInterp</a></span><span> : <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-S/index.html#type-custom_float">custom_float</a> = <a href="../Bir_number/MPFRNumber/index.html#type-t">Bir_number.MPFRNumber.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-BigIntDefInterp" class="anchored"><a href="#module-BigIntDefInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="BigIntDefInterp/index.html">BigIntDefInterp</a></span><span> : <a href="module-type-S/index.html">S</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-BigIntMultInterp" class="anchored"><a href="#module-BigIntMultInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="BigIntMultInterp/index.html">BigIntMultInterp</a></span><span> : <a href="module-type-S/index.html">S</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-BigIntMfInterp" class="anchored"><a href="#module-BigIntMfInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="BigIntMfInterp/index.html">BigIntMfInterp</a></span><span> : <a href="module-type-S/index.html">S</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-IntvDefInterp" class="anchored"><a href="#module-IntvDefInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="IntvDefInterp/index.html">IntvDefInterp</a></span><span> : <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-S/index.html#type-custom_float">custom_float</a> = <a href="../Bir_number/IntervalNumber/index.html#type-t">Bir_number.IntervalNumber.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-IntvMultInterp" class="anchored"><a href="#module-IntvMultInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="IntvMultInterp/index.html">IntvMultInterp</a></span><span> : <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-S/index.html#type-custom_float">custom_float</a> = <a href="../Bir_number/IntervalNumber/index.html#type-t">Bir_number.IntervalNumber.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-IntvMfInterp" class="anchored"><a href="#module-IntvMfInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="IntvMfInterp/index.html">IntvMfInterp</a></span><span> : <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-S/index.html#type-custom_float">custom_float</a> = <a href="../Bir_number/IntervalNumber/index.html#type-t">Bir_number.IntervalNumber.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-RatDefInterp" class="anchored"><a href="#module-RatDefInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="RatDefInterp/index.html">RatDefInterp</a></span><span> : <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-S/index.html#type-custom_float">custom_float</a> = <a href="../Bir_number/RationalNumber/index.html#type-t">Bir_number.RationalNumber.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-RatMultInterp" class="anchored"><a href="#module-RatMultInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="RatMultInterp/index.html">RatMultInterp</a></span><span> : <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-S/index.html#type-custom_float">custom_float</a> = <a href="../Bir_number/RationalNumber/index.html#type-t">Bir_number.RationalNumber.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-RatMfInterp" class="anchored"><a href="#module-RatMfInterp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="RatMfInterp/index.html">RatMfInterp</a></span><span> : <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-S/index.html#type-custom_float">custom_float</a> = <a href="../Bir_number/RationalNumber/index.html#type-t">Bir_number.RationalNumber.t</a></span></span></code></div></div><h2 id="generic-interpretation-api"><a href="#generic-interpretation-api" class="anchor"></a>Generic interpretation API</h2><div class="odoc-spec"><div class="spec value" id="val-get_interp" class="anchored"><a href="#val-get_interp" class="anchor"></a><code><span><span class="keyword">val</span> get_interp : <span><a href="../Cli/index.html#type-value_sort">Cli.value_sort</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Cli/index.html#type-round_ops">Cli.round_ops</a> <span class="arrow">&#45;&gt;</span></span> <span>(<span class="keyword">module</span> <a href="module-type-S/index.html">S</a>)</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-evaluate_program" class="anchored"><a href="#val-evaluate_program" class="anchor"></a><code><span><span class="keyword">val</span> evaluate_program : 
  <span><a href="../Bir_interface/index.html#type-bir_function">Bir_interface.bir_function</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Bir/index.html#type-program">Bir.program</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Mir/index.html#type-literal">Mir.literal</a> <a href="../Bir/VariableMap/index.html#type-t">Bir.VariableMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Cli/index.html#type-value_sort">Cli.value_sort</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Cli/index.html#type-round_ops">Cli.round_ops</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Main interpreter function</p></div></div><div class="odoc-spec"><div class="spec value" id="val-evaluate_expr" class="anchored"><a href="#val-evaluate_expr" class="anchor"></a><code><span><span class="keyword">val</span> evaluate_expr : 
  <span><a href="../Mir/index.html#type-program">Mir.program</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Bir/index.html#type-expression">Bir.expression</a> <a href="../Pos/index.html#type-marked">Pos.marked</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Cli/index.html#type-value_sort">Cli.value_sort</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Cli/index.html#type-round_ops">Cli.round_ops</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../Mir/index.html#type-literal">Mir.literal</a></span></code></div><div class="spec-doc"><p>Interprets only an expression</p></div></div></div></body></html>